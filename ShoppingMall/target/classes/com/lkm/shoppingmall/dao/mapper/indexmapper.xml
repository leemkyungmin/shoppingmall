<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.lkm.shoppingmall.dao.indexDAO">
	<select id="getbanner" resultType="com.lkm.shoppingmall.dto.bannerDto">
		SELECT *
		FROM BANNER
	</select>
	<select id="searchResult" parameterType="String" resultType="com.lkm.shoppingmall.dto.searchDto">
		SELECT p.PIDX,p.PRICE,p.PNAME,NVL(AVG(r.RATING),0) AS rRATING,NVL(COUNT(r.PIDX),0) AS rRCOUNT,d.DNAME,TO_CHAR(p.pSumnail) as pSumnail 
		FROM PRODUCTS p LEFT OUTER JOIN REVIEW R on p.PIDX = R.PIDX , DEPT d
		WHERE p.PNAME LIKE '%' || #{param1} ||'%' 
		and  p.DIDX = d.DIDX 
        group by p.PIDX,p.PRICE, p.PNAME,d.DNAME,TO_CHAR(p.pSumnail)
	</select>
 
</mapper>